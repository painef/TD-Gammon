---
title: "final_project"
author: "Sally Matson"
date: "4/27/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("vanilla_r_nn.R")
source("agents.R")
source("nn-utils.R")
source("backgammon_board.R")
source("eval.R")
library(zeallot)
```

## Value Function
```{r}
print.fun('fwd.prop')
```


## Gradient Calculations
We used a basic backpropegation algorithm for our calculations.
```{r}
print.fun('bk.prop')
```


Training with sigmoid activations for all layers, $\alpha=0.1$, and $\lambda=0.8$.
```{r sigmoid basic, cache=TRUE}
max.games = 50000
eval_freq = 2000
untrained_agent = make_vanilla_agent(40,sigmoid,dsigmoid,n.in=28)
trained_agent.50000 = nnet1.fit(untrained_agent,0.1,0.8,max.games,TRUE,eval_freq)
trained_agent.100000 = nnet1.fit(trained_agent.50000$agent,0.1,0.8,max.games,TRUE,eval_freq)
trained_agent.150000 = nnet1.fit(trained_agent.100000$agent,0.1,0.8,max.games,TRUE,eval_freq)
trained_agent.200000 = nnet1.fit(trained_agent.150000$agent,0.1,0.8,max.games,TRUE,eval_freq)
```


```{r}


cost_hist = c(trained_agent.50000$cost, trained_agent.100000$cost, trained_agent.150000$cost, trained_agent.200000$cost)

plot(0,0,xlim=c(0,length(cost_hist)),ylim=c(0,0.02), type="n", ylab="", xlab="Epochs")
lines(x=seq(1,length(cost_hist)), y=cost_hist, col="red")
abline(lm(unlist(cost_hist) ~ seq(1,length(cost_hist))))


eval_hist = c(trained_agent.50000$eval_hist, trained_agent.100000$eval_hist, trained_agent.150000$eval_hist, trained_agent.200000$eval_hist)
plot(0,0,xlim=c(0,length(eval_hist)),ylim=c(0,1), type="n", ylab="", xlab="Epochs")
points(x=seq(1,length(eval_hist)), y=eval_hist, col="red")
abline(lm(unlist(eval_hist) ~ seq(1,length(eval_hist))))
```
